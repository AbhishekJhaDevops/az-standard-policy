{
  "name": "DFC10",
  "type": "Microsoft.Authorization/policyDefinitions",
  "apiVersion": "2021-06-01",
  "scope": null,
  "properties": {
    "displayName": "SQL Server Integration Services integration runtimes on Azure Data Factory should be joined to a virtual network",
    "policyType": "Custom",
    "mode": "All",
    "description": "Azure Virtual Network deployment provides enhanced security and isolation for your SQL Server Integration Services integration runtimes on Azure Data Factory, as well as subnets, access control policies, and other features to further restrict access.",
    "metadata": {
      "version": "1.0.0",
      "category": "SPC Common"
    },
    "version": "1.0.0",
    "parameters": {
      "effect": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "The effect determines what happens when the policy rule is evaluated to match."
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      }
    },
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.DataFactory/factories/integrationRuntimes"
          },
          {
            "field": "Microsoft.DataFactory/factories/integrationruntimes/type",
            "equals": "Managed"
          },
          {
            "field": "Microsoft.DataFactory/factories/integrationruntimes/typeProperties.ssisProperties",
            "exists": "true"
          },
          {
            "allOf": [
              {
                "field": "Microsoft.DataFactory/factories/integrationRuntimes/Managed.typeProperties.computeProperties.vnetProperties.vnetId",
                "exists": "false"
              },
              {
                "field": "Microsoft.DataFactory/factories/integrationRuntimes/Managed.typeProperties.computeProperties.vNetProperties.subnetId",
                "exists": "false"
              },
              {
                "field": "Microsoft.DataFactory/factories/integrationRuntimes/Managed.typeProperties.customerVirtualNetwork.subnetId",
                "exists": "false"
              }
            ]
          }
        ]
      },
      "then": {
        "effect": "[parameters('effect')]"
      }
    }
  }
}