{
  "name": "CDS001",
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2021-06-01",
  "scope": null,
  "properties": {
    "policyType": "Custom",
    "displayName": "[CDS001] Security Benchmark",
    "description": "This policy set enables the security benchmark for Azure SQL Managed Instance, Azure Arc-enabled SQL Managed Instance, and SQL Server on Azure Virtual Machines. The policy set includes policies to enable Azure Monitor Agent, Data Collection Rule, and Log Analytics workspace for SQL Managed Instance, Azure Arc-enabled SQL Managed Instance, and SQL Server on Azure Virtual Machines.",
    "metadata": {
      "version": "1.0.0",
      "category": "SPC Common"
    },
    "parameters": {
      "effect-AzKeyVaultFwEnabled": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "restrictIPAddresses-AzKeyVaultFwEnabled": {
        "type": "String",
        "metadata": {
          "displayName": "Would you like to restrict specific IP addresses?",
          "description": "Select (Yes) to allow or forbid a list of IP addresses. If (No), the list of IP addresses won't have any effect in the policy enforcement"
        },
        "allowedValues": [
          "Yes",
          "No"
        ],
        "defaultValue": "No"
      },
      "allowedIPAddresses-AzKeyVaultFwEnabled": {
        "type": "Array",
        "metadata": {
          "displayName": "Allowed IP addresses",
          "description": "Array with allowed public IP addresses. An empty array is evaluated as to allow all IPs."
        },
        "defaultValue": []
      },
      "forbiddenIPAddresses-AzKeyVaultFwEnabled": {
        "type": "Array",
        "metadata": {
          "displayName": "Forbidden IP addresses",
          "description": "Array with forbidden public IP addresses. An empty array is evaluated as there are no forbidden IP addresses."
        },
        "defaultValue": []
      },
      "effect-StgAccPreventCrossTenantObjReplicn": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "The effect determines what happens when the policy rule is evaluated to match"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-VnetProtectedAzDDoSProtect": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Modify",
          "Audit",
          "Disabled"
        ],
        "defaultValue": "Modify"
      },
      "ddosPlan-VnetProtectedAzDDoSProtect": {
        "type": "String",
        "metadata": {
          "displayName": "DDoS Protection Plan",
          "description": "DDoS Protection Plan resource to be associated to the virtual networks",
          "strongType": "Microsoft.Network/ddosProtectionPlans"
        }
      },
      "effect-AzKvDisPubAcc": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-PostgreSqlFlexSerTLS1.2OrNewer": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-AzSqlMangdDisablepubAcc": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-ConfAzSqlServDisPubNetAcc": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Modify",
          "Disabled"
        ],
        "defaultValue": "Modify"
      },
      "logAnalytics-ConfAzActivityLogsStreamSpecifiedLAW": {
        "type": "String",
        "metadata": {
          "displayName": "Primary Log Analytics workspace",
          "description": "If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
          "strongType": "omsWorkspace",
          "assignPermissions": true
        }
      },
      "effect-ConfAzActivityLogsStreamSpecifiedLAW": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "defaultValue": "DeployIfNotExists"
      },
      "logsEnabled-ConfAzActivityLogsStreamSpecifiedLAW": {
        "type": "String",
        "metadata": {
          "displayName": "Enable logs",
          "description": "Whether to enable logs stream to the Log Analytics workspace - True or False"
        },
        "allowedValues": [
          "True",
          "False"
        ],
        "defaultValue": "True"
      },
      "effect-StgAccMinimumTLSVersion": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the audit policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "minimumTlsVersion-StgAccMinimumTLSVersion": {
        "type": "String",
        "metadata": {
          "displayName": "Minimum TLS Version",
          "description": "Minimum version of TLS required to access data in this storage account"
        },
        "allowedValues": [
          "TLS1_0",
          "TLS1_1",
          "TLS1_2"
        ],
        "defaultValue": "TLS1_2"
      },
      "effect-DenyCreationLbWithPubIps": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-ConfStgAccDisablePubAccess": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Modify",
          "Disabled"
        ],
        "defaultValue": "Modify"
      },
      "effect-AppServEnvProviWithLatestVersion": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AppServiceEnvironment": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-GuestAccReadPermissions": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-EnforceSSlConnEnabled": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-ContAppEnvNetwkInjectns": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ],
        "defaultValue": "Audit"
      },
      "effect-AppSerAppInjecVnet": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-SQLServerIntegrationServices": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AzdataBricksWorksVnet": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AppServiceSlotOutboundnonRFCTraficVnet": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AppServiceAppEnableConfigrouteVnet": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AzDefenderKvEnable": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-GuestAccWithPermissionsAzResource": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-ContAppDisableNetAcc": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-PvEndPointEnabledPostgreSQLFlexServer": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-AppServiceAppSlotsAccHTTPS": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ],
        "defaultValue": "Audit"
      },
      "effect-PubNetAccAzSQLDbDisabled": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-PubNetAccDisPostgreSql": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },

      "effect-AppServiceHTTPVersion": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-AppServiceAppSlotsDebug": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-PubNetAccDisabledMariaDB": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-MicrosoftAntiMalwareAzAutoProtectionSign": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-ModifyConfAzFiledisPubNetAccess": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Modify",
          "Disabled"
        ],
        "defaultValue": "Modify"
      },
      "effect-AzKvRBACPermissionModel": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AzDataBricksWorkSpacePvLink": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-SqlMangdInstanceMinimalTlsVer1.2": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AppSerAppSlotsShouldEnableConfRoutingVnet": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-PubNetAccBeDisPostgreFlexServer": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-PvEndpointEnabledPostgreFlexServer": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-PubNetAccDisabledMySQLServers": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AppSerEndpointTls1.0And1.1Disabled": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-PubNetAccShouldDisabledMySqlFlexServer": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-KvDeletionProtection": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-ContRegshouldusePrivateLink": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-ContAppsEnvDisablePubNetworkAccess": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-Tls1.2ArcSqlMangdInstance": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AppSlotsCORSConfResource": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-AzKvMangdHSMPvLink": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AppSerSlotsUseLatestTLSVersion": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-NetAppVolNSF4.1KerbosDataEncryption": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AppServiceShouldHaveRemDebuggTurnedOff": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-AciContAppDeployVnet": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ],
        "defaultValue": "Audit"
      },
      "effect-AppServAppVnetSerEndpoint": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-AppSerOutBoundnonRFCTraffVnet": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-AzDefenderAzSQLDbEnabled": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-AppSerAppInjectVnet": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-PubNetAccAzFileSync": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-PvEndpointEnabledMySqlServers": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-EventhubVnetEndpoint": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "defaultValue": "AuditIfNotExists"
      },
      "effect-AzNetAppFilesSMBVolSMB3Encryption": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Audit"
      },
      "effect-ConfCognitiveAccDisPubNetAcc": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "Disabled",
          "Modify"
        ],
        "defaultValue": "Modify"
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "AzKeyVaultFwEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AzKeyVaultFwEnabled')]"
          },
          "restrictIPAddresses": {
            "value": "[[parameters('restrictIPAddresses-AzKeyVaultFwEnabled')]"
          },
          "allowedIPAddresses": {
            "value": "[[parameters('allowedIPAddresses-AzKeyVaultFwEnabled')]"
          },
          "forbiddenIPAddresses": {
            "value": "[[parameters('forbiddenIPAddresses-AzKeyVaultFwEnabled')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "StgAccPreventCrossTenantObjReplicn",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/92a89a79-6c52-4a7e-a03f-61306fc49312",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-StgAccPreventCrossTenantObjReplicn')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "VnetProtectedAzDDoSProtect",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-VnetProtectedAzDDoSProtect')]"
          },
          "ddosPlan": {
            "value": "[[parameters('ddosPlan-VnetProtectedAzDDoSProtect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "NetwkInterfacePubIps",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AzKvDisPubAcc",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AzKvDisPubAcc')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PostgreSqlFlexSerTLS1.2OrNewer",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a43d5475-c569-45ce-a268-28fa79f4e87a",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PostgreSqlFlexSerTLS1.2OrNewer')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AzSqlMangdDisablepubAcc",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9dfea752-dd46-4766-aed1-c355fa93fb91",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AzSqlMangdDisablepubAcc')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ConfAzSqlServDisPubNetAcc",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/28b0b1e5-17ba-4963-a7a4-5a1ab4400a0b",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-ConfAzSqlServDisPubNetAcc')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ConfAzActivityLogsStreamSpecifiedLAW",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics-ConfAzActivityLogsStreamSpecifiedLAW')]"
          },
          "effect": {
            "value": "[[parameters('effect-ConfAzActivityLogsStreamSpecifiedLAW')]"
          },
          "logsEnabled": {
            "value": "[[parameters('logsEnabled-ConfAzActivityLogsStreamSpecifiedLAW')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "StgAccMinimumTLSVersion",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe83a0eb-a853-422d-aac2-1bffd182c5d0",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-StgAccMinimumTLSVersion')]"
          },
          "minimumTlsVersion": {
            "value": "[[parameters('minimumTlsVersion-StgAccMinimumTLSVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DenyCreationLbWithPubIps",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC01",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-DenyCreationLbWithPubIps')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ConfStgAccDisablePubAccess",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC02",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-ConfStgAccDisablePubAccess')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServEnvProviWithLatestVersion",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC03",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppServEnvProviWithLatestVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServiceEnvironment",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC03",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppServiceEnvironment')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "GuestAccReadPermissions",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC04",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-GuestAccReadPermissions')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "EnforceSSlConnEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC06",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-EnforceSSlConnEnabled')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ContAppEnvNetwkInjectns",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC08",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-ContAppEnvNetwkInjectns')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppSerAppInjecVnet",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC09",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppSerAppInjecVnet')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SQLServerIntegrationServices",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC10",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-SQLServerIntegrationServices')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AzdataBricksWorksVnet",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC11",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AzdataBricksWorksVnet')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServiceSlotOutboundnonRFCTraficVnet",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC12",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppServiceSlotOutboundnonRFCTraficVnet')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServiceAppEnableConfigrouteVnet",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC14",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppServiceAppEnableConfigrouteVnet')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AzDefenderKvEnable",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC15",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AzDefenderKvEnable')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "GuestAccWithPermissionsAzResource",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC16",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-GuestAccWithPermissionsAzResource')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ContAppDisableNetAcc",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC17",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-ContAppDisableNetAcc')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PvEndPointEnabledPostgreSQLFlexServer",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC18",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PvEndPointEnabledPostgreSQLFlexServer')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServiceAppSlotsAccHTTPS",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC19",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppServiceAppSlotsAccHTTPS')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PubNetAccAzSQLDbDisabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC20",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PubNetAccAzSQLDbDisabled')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PubNetAccDisPostgreSql",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC21",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PubNetAccDisPostgreSql')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServiceHTTPVersion",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC23",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppServiceHTTPVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServiceAppSlotsDebug",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC27",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppServiceAppSlotsDebug')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PubNetAccDisabledMariaDB",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC29",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PubNetAccDisabledMariaDB')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "MicrosoftAntiMalwareAzAutoProtectionSign",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC32",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-MicrosoftAntiMalwareAzAutoProtectionSign')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ModifyConfAzFiledisPubNetAccess",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC33",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-ModifyConfAzFiledisPubNetAccess')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AzKvRBACPermissionModel",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC41",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AzKvRBACPermissionModel')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AzDataBricksWorkSpacePvLink",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC42",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AzDataBricksWorkSpacePvLink')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DenyPvEndpointCrossSubsCreation",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC43",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SqlMangdInstanceMinimalTlsVer1.2",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC44",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-SqlMangdInstanceMinimalTlsVer1.2')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DenyPvEndpontCrossSubsCreation",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC44",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppSerAppSlotsShouldEnableConfRoutingVnet",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC46",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppSerAppSlotsShouldEnableConfRoutingVnet')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PubNetAccBeDisPostgreFlexServer",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC50",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PubNetAccBeDisPostgreFlexServer')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PvEndpointEnabledPostgreFlexServer",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC52",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PvEndpointEnabledPostgreFlexServer')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PubNetAccDisabledMySQLServers",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC53",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PubNetAccDisabledMySQLServers')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppSerEndpointTls1.0And1.1Disabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC56",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppSerEndpointTls1.0And1.1Disabled')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PubNetAccShouldDisabledMySqlFlexServer",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC57",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PubNetAccShouldDisabledMySqlFlexServer')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "KvDeletionProtection",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC58",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-KvDeletionProtection')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ContRegshouldusePrivateLink",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC59",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-ContRegshouldusePrivateLink')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ContAppsEnvDisablePubNetworkAccess",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC61",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-ContAppsEnvDisablePubNetworkAccess')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Tls1.2ArcSqlMangdInstance",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC62",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-Tls1.2ArcSqlMangdInstance')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppSlotsCORSConfResource",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC63",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppSlotsCORSConfResource')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AzKvMangdHSMPvLink",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC64",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AzKvMangdHSMPvLink')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppSerSlotsUseLatestTLSVersion",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC65",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppSerSlotsUseLatestTLSVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "NetAppVolNSF4.1KerbosDataEncryption",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC68",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-NetAppVolNSF4.1KerbosDataEncryption')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServiceShouldHaveRemDebuggTurnedOff",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC69",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppServiceShouldHaveRemDebuggTurnedOff')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AciContAppDeployVnet",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC70",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AciContAppDeployVnet')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServAppVnetSerEndpoint",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC71",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppServAppVnetSerEndpoint')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppSerOutBoundnonRFCTraffVnet",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC72",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppSerOutBoundnonRFCTraffVnet')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AzDefenderAzSQLDbEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC73",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AzDefenderAzSQLDbEnabled')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppSerAppInjectVnet",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC74",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AppSerAppInjectVnet')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PubNetAccAzFileSync",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC75",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PubNetAccAzFileSync')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PvEndpointEnabledMySqlServers",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC76",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-PvEndpointEnabledMySqlServers')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "EventhubVnetEndpoint",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC78",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-EventhubVnetEndpoint')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AzNetAppFilesSMBVolSMB3Encryption",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC84",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-AzNetAppFilesSMBVolSMB3Encryption')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ConfCognitiveAccDisPubNetAcc",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/DFC85",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect-ConfCognitiveAccDisPubNetAcc')]"
          }
        },
        "groupNames": []
      }
    ],
    "policyDefinitionGroups": null
  }
}