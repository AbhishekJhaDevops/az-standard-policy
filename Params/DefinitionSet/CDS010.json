{
    "name": "CDS010-Network-Security",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
      "policyType": "Custom",
      "displayName": "CDS010-Network-Security",
      "description": "Industrial Common Network Security Initiative Policy",
      "metadata": {
        "version": "1.0.0",
        "category": "SPC Common"
      },
      "parameters": {
        "Effect-AllPortsRestrictedOnNSGVM": {
          "type": "string",
          "metadata": {
            "displayName": "Effect",
            "description": "Enable or disable the execution of the policy"
          },
          "allowedValues": [
            "AuditIfNotExists",
            "Disabled"
          ],
          "defaultValue": "AuditIfNotExists"
        },
        "Effect-internetVirtualMachinesProtectedNSG": {
          "type": "string",
          "metadata": {
            "displayName": "Effect",
            "description": "Enable or disable the execution of the policy"
          },
          "allowedValues": [
            "AuditIfNotExists",
            "Disabled"
          ],
          "defaultValue": "AuditIfNotExists"
        },
        "Effect-nonInternetVirtialMachinesProtectedNSG": {
          "type": "string",
          "metadata": {
            "displayName": "Effect",
            "description": "Enable or disable the execution of the policy"
          },
          "allowedValues": [
            "AuditIfNotExists",
            "Disabled"
          ],
          "defaultValue": "AuditIfNotExists"
        },
        "Effect-subnetAssociatedWithNSG": {
          "type": "String",
          "metadata": {
            "displayName": "Effect",
            "description": "Enable or disable the execution of this policy"
          },
          "allowedValues": [
            "AuditIfNotExists",
            "Disabled"
          ],
          "defaultValue": "AuditIfNotExists"
        }
      },
      "policyDefinitions": [
        {
          "policyDefinitionReferenceId": "AllPortsRestrictedOnNSGVM",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
          "parameters": {
            "effect": {
              "value": "[[parameters('Effect-AllPortsRestrictedOnNSGVM')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "internetVirtualMachinesProtectedNSG",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c",
          "parameters": {
            "effect": {
              "value": "[[parameters('Effect-internetVirtualMachinesProtectedNSG')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "nonInternetVirtialMachinesProtectedNSG",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bb91dfba-c30d-4263-9add-9c2384e659a6",
          "parameters": {
            "effect": {
              "value": "[[parameters('Effect-nonInternetVirtialMachinesProtectedNSG')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "subnetAssociatedWithNSG",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517",
          "parameters": {
            "effect": {
              "value": "[[parameters('Effect-subnetAssociatedWithNSG')]"
            }
          },
          "groupNames": []
        }
      ],
      "policyDefinitionGroups": null
    }
  }