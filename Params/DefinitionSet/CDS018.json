{
    "name": "CDS018-Auth-Mgmt-User-Accounts",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
      "policyType": "Custom",
      "displayName": "CDS018-Auth-Mgmt-User-Accounts",
      "description": "When accessing Azure Resources, only approved applications and secure protocols should be used... initiative policy",
      "metadata": {
        "version": "1.0.0",
        "category": "SPC Common"
      },
      "parameters": {
        "Effect-AppServiceResourceLogsEnabled": {
          "type": "string",
          "metadata": {
            "displayName": "Effect",
            "description": "Enable or disable the execution of the policy"
          },
          "allowedValues": [
            "AuditIfNotExists",
            "Disabled"
          ],
          "defaultValue": "AuditIfNotExists"
        },
        "requiredRetentionDays-AppServiceRequiredRetentionDays": {
          "type": "string",
          "metadata": {
            "displayName": "Required retention (days)",
            "description": "The required resource logs retention in days"
          },
          "defaultValue": "365"
        },
        "Effect-ResourceLogsKeyVault": {
          "type": "string",
          "metadata": {
            "displayName": "Effect",
            "description": "Enable or disable the execution of the policy"
          },
          "allowedValues": [
            "AuditIfNotExists",
            "Disabled"
          ],
          "defaultValue": "AuditIfNotExists"
        },
        "requiredRetentionDays-ResourceLogsKeyVault": {
          "type": "string",
          "metadata": {
            "displayName": "Required retention (days)",
            "description": "The required resource logs retention in days"
          },
          "defaultValue": "365"
        },
        "Effect-NetworkTrafficDataCollectionLinVM": {
          "type": "string",
          "metadata": {
            "displayName": "Effect",
            "description": "Enable or disable the execution of the policy"
          },
          "allowedValues": [
            "AuditIfNotExists",
            "Disabled"
          ],
          "defaultValue": "AuditIfNotExists"
        },
        "Effect-NetworkTrafficDataCollectionWinVM": {
          "type": "String",
          "metadata": {
            "displayName": "Effect",
            "description": "Enable or disable the execution of this policy"
          },
          "allowedValues": [
            "AuditIfNotExists",
            "Disabled"
          ],
          "defaultValue": "AuditIfNotExists"
        }
      },
      "policyDefinitions": [
        {
          "policyDefinitionReferenceId": "AppServiceResourceLogsEnabled",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/91a78b24-f231-4a8a-8da9-02c35b2b6510",
          "parameters": {
            "effect": {
              "value": "[[parameters('Effect-AppServiceResourceLogsEnabled')]"
            },
            "requiredRetentionDays": {
                "value": "[[parameters('requiredRetentionDays-AppServiceRequiredRetentionDays')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "ResourceLogsKeyVault",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
          "parameters": {
            "effect": {
              "value": "[[parameters('Effect-ResourceLogsKeyVault')]"
            },
            "requiredRetentionDays":{
                "value": "[[parameters('requiredRetentionDays-ResourceLogsKeyVault')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "NetworkTrafficDataCollectionLinVM",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/04c4380f-3fae-46e8-96c9-30193528f602",
          "parameters": {
            "effect": {
              "value": "[[parameters('Effect-NetworkTrafficDataCollectionLinVM')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "NetworkTrafficDataCollectionWinVM",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2f2ee1de-44aa-4762-b6bd-0893fc3f306d",
          "parameters": {
            "effect": {
              "value": "[[parameters('Effect-NetworkTrafficDataCollectionWinVM')]"
            }
          },
          "groupNames": []
        }
      ],
      "policyDefinitionGroups": null
    }
  }